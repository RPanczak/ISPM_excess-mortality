---
title: "Excess mortality"
subtitle: "Weekly BfS data - alternative sources"
author: "Radek Panczak"
date: "`r Sys.Date()`"
output:
  rmdformats::robobook:
    code_folding: show
    self_contained: true
    highlight: pygments
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
set.seed(12345)
options(scipen=999)
options(max.print = "75")

library(pacman)
p_load(tidyverse, readxl, scales, janitor, kableExtra)
```

```{r knit-setup, include = FALSE}
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

knitr::opts_chunk$set(cache = FALSE,
                      prompt = FALSE,
                      tidy = FALSE,
                      comment = NA,
                      message = FALSE,
                      warning = FALSE)

knitr::opts_knit$set(width = 75)

mu <- Hmisc::markupSpecs$html
```

<!-- ----------------------------------------------------- -->

# BfS - "Population" chapter

Alternative sources. Not needed so left **UNFINISHED** in terms of processing as placeholder for documenting links and names...  

2019 
canton
https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/tables.assetdetail.17004426.html
gr
https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/tables.assetdetail.17004450.html

Docs in `ts-q-01.04.02.01.30-APPENDIX.xlsx`

2020 
canon
https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/tables.assetdetail.15464210.html
gr
https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/tables.assetdetail.15464206.html

Docs in `ts-q-01.04.02.01.30-2020-APPENDIX.xlsx`

2021
canton
https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/tables.assetdetail.13187299.html
gr
https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/tables.assetdetail.13187304.html

Docs in `ts-q-01.04.02.01.30-2021-APPENDIX.xlsx`

## Deaths per week by 5-year age group, sex and canton

```{r eval=FALSE}
download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/13187299/master",
              destfile = "data-raw/BfS/weekly_canton_age5_2000-2019.csv", 
              method = "curl")

download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/15464210/master",
              destfile = "data-raw/BfS/weekly_canton_age5_2020.csv", 
              method = "curl")

download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/17004426/master",
              destfile = "data-raw/BfS/weekly_canton_age5_2021.csv", 
              method = "curl")
```

```{r eval=FALSE}
weekly_canton_age5_2000_2019 <- read_delim("data-raw/BfS/weekly_canton_age5_2000-2019.csv", ";", escape_double = FALSE, col_types = cols(OBS_VALUE = col_integer()), trim_ws = TRUE)

weekly_canton_age5_2020 <- read_delim("data-raw/BfS/weekly_canton_age5_2020.csv", ";", escape_double = FALSE, col_types = cols(OBS_VALUE = col_integer()), trim_ws = TRUE)

weekly_canton_age5_2021 <- read_delim("data-raw/BfS/weekly_canton_age5_2021.csv", ";", escape_double = FALSE, col_types = cols(OBS_VALUE = col_integer()), trim_ws = TRUE)
```

<!-- ----------------------------------------------------- -->

# BfS - MOMO

Alternative sources. Not needed so left **UNFINISHED** in terms of processing as placeholder for documenting links and names...  

BfS [Mortality monitoring (MOMO)](https://www.experimental.bfs.admin.ch/expstat/en/home/innovative-methods/momo.html) 

## Deaths in NUTS2-regions, age group 0 - 64 years, 2020-2021

```{r eval=FALSE}
download.file(url = "https://www.experimental.bfs.admin.ch/bfsstatic/dam/assets/16584743/master",
              destfile = "data-raw/BfS/momo_nuts_0-64_2020-2021.csv", 
              method = "curl")
```

## Deaths in NUTS2-regions, age group 65 years and older, 2020-2021

```{r eval=FALSE}
download.file(url = "https://www.experimental.bfs.admin.ch/bfsstatic/dam/assets/16584737/master",
              destfile = "data-raw/BfS/momo_nuts_65_2020-2021.csv", 
              method = "curl")
```

## Weekly deaths 2020-2021 for 26 cantons and 2 age groups

```{r eval=FALSE}
download.file(url = "https://www.experimental.bfs.admin.ch/bfsstatic/dam/assets/16584735/master",
              destfile = "data-raw/BfS/momo_canton_age-bin_2020-2021.csv", 
              method = "curl")
```

<!-- ----------------------------------------------------- -->

# Computing Environment

`r mu$session()`